## 注册功能
    表单：
    用户名username -- user
    密码password -- user -- 一级加密随机五位数salt -- 二级加密 md5(password + salt)
    邮箱email -- 随机激活码

    用户操作：
    用户点击注册按钮，跳转到注册页面，之后输入账号密码，确认密码和邮箱，然后点击确认注册
    服务器操作：
    前端接收用户提交的数据，并向后端发送请求，要求处理数据
    后端先判断用户名是否存在（根据username查user）
        后端接收前端数据并对数据进行判断
            如果用户在数据库中存在则向前端发出提示,停止处理
            如果用户不存在将用户注册信息存入数据库，账户状态为未激活
        然后向用户注册用的邮箱发送一封激活邮件
            邮件链接就是项目路径+/activation/userId/code

    用户操作：
    用户点击激活链接。(激活重复点击链接，登陆状态点击链接之前就是激活状态，验证激活码正确 激活成功，验证激活码错误 激活失败)
    服务器操作：
    服务器解析激活链接，找到数据库中对应的用户，激活码正确，修改用户状态为激活
    跳转请求到邮件激活页，成功就到成功激活页，失败就到失败激活页。

    先从前端获取表单数据

### 注册功能
    面试官：你这个注册功能怎么做的呀
    分别从用户的注册流程和后台开发流程介绍下
    从用户注册流程来看
        假如用户在登录页，用户输入用户名，密码和邮箱，点击注册后，会收到一封验证邮件，点击邮件内链接，验证注册，验证成功来到登录页，验证失败，来到信息提示页
    功能点分析：
        密码加密，发送激活码邮件，验证激活码，修改用户激活状态
    后台编写顺序
    前端
        修改前端跳转地址,确保跳转正常
    数据层
        根据name查user
        根据email查user
        插入user
    业务层
        由于要验证前端传来的数据,所以我们要返回一个Map类型的数组
        验证用户名
        验证用户邮箱
        插入用户,设置用户状态未激活

        验证用户激活码
    控制层
        注册用户，并向用户发送激活码
        验证用户激活码后根据验证结果控制视图跳转

### 登录功能：
    用户流程：
        输入账号密码，输入验证码，可选长登录状态，点击登录，成功重定向主页，失败返回错误信息
    功能点分析：
        验证码功能，Cookie，Session会话管理，两种登陆保持状态
    验证码：
        kaptcha生成验证码，将验证码存入session，与用户输入的验证码作比较
    数据层：
        根据username查用户
        根据userId查询登陆表
        更新登陆表中登陆状态
    业务层:
        验证username
        验证password
        更新用户登陆状态
    表现层：
        检查验证码
        根据rememberMe设置登录持续时间（三元表达式）
        创建Cookie，设置路径与最大存活时间，存入ticket
        控制视图跳转，重定向首页

    th:checked="${param.rememberMe} 
    mapper类中参数字段要与xml配置文件中参数字段一致

### 更新登录后页面
    拦截器：统一处理多个请求的操作
    -定义拦截器：实现HandlerInterceptor接口
    -配置拦截器，实现WebMvcConfigur接口，注册拦截器，排除静态资源
    
    -自定义拦截器
        先封装一个工具类，从request获取cookie，从cookie中取出ticket的值
        preHandler  通过ticket的值查询到用户，并将用户保存，set进线程组
            HostHolder
                    由于服务器对应多个客户端，属于一对多的情况，考虑线程隔离，
                    故通过ThreadLocal方式保存用户，先创建一个用户的线程组，
                    设置将用户存入线程组，在从线程组中将用户取出
                    定义一个销毁线程组的方法，避免只存不出，导致资源浪费
    
        postHandler 从线程组中取出用户，并将用户通过ModelAndView返回给前端

        afterHandler 在返回视图后，关闭连接前，将用户移除

### 账号设置
    - 上传头像
    - 修改密码
    上传文件
        - POST请求
        - encType:"multipart/form-data"
        - Spring MVC: 通过MultipartFile上传文件
    开发步骤
        - 访问账号设置页面
        - 上传头像
        - 更新头像

### 检测登陆状态
    - 防止未登录用户通过路径访问登陆后功能
    处理批量请求,考虑使用拦截器,不需要拦截所有,可以自定义注解,用注解对方法进行标记,只拦截有注解的方法
    - 检测登陆状态,如果未登录,则拦截所有请求,只检测带有该注解的方法 (设置页方法,更新头像)

### 前缀树
    前缀树
    - Trie字典树,查找树
    - 查询效率高,花费内存大
    - 字符串检索,词频统计,字符串排序

    敏感词过滤器
    - 定义敏感词
    - 根据敏感词初始化前缀树结构
    - 编写过滤敏感词方法