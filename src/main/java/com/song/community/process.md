## 注册功能
    表单：
    用户名username -- user
    密码password -- user -- 一级加密随机五位数salt -- 二级加密 md5(password + salt)
    邮箱email -- 随机激活码

    用户操作：
    用户点击注册按钮，跳转到注册页面，之后输入账号密码，确认密码和邮箱，然后点击确认注册
    服务器操作：
    前端接收用户提交的数据，并向后端发送请求，要求处理数据
    后端先判断用户名是否存在（根据username查user）
        后端接收前端数据并对数据进行判断
            如果用户在数据库中存在则向前端发出提示,停止处理
            如果用户不存在将用户注册信息存入数据库，账户状态为未激活
        然后向用户注册用的邮箱发送一封激活邮件
            邮件链接就是项目路径+/activation/userId/code

    用户操作：
    用户点击激活链接。(激活重复点击链接，登陆状态点击链接之前就是激活状态，验证激活码正确 激活成功，验证激活码错误 激活失败)
    服务器操作：
    服务器解析激活链接，找到数据库中对应的用户，激活码正确，修改用户状态为激活
    跳转请求到邮件激活页，成功就到成功激活页，失败就到失败激活页。

    先从前端获取表单数据

### 注册功能
    面试官：你这个注册功能怎么做的呀
    分别从用户的注册流程和后台开发流程介绍下
    从用户注册流程来看
        假如用户在登录页，用户输入用户名，密码和邮箱，点击注册后，会收到一封验证邮件，点击邮件内链接，验证注册，验证成功来到登录页，验证失败，来到信息提示页
    功能点分析：
        密码加密，发送激活码邮件，验证激活码，修改用户激活状态
    后台编写顺序
    前端
        修改前端跳转地址,确保跳转正常
    数据层
        根据name查user
        根据email查user
        插入user
    业务层
        由于要验证前端传来的数据,所以我们要返回一个Map类型的数组
        验证用户名
        验证用户邮箱
        插入用户,设置用户状态未激活

        验证用户激活码
    控制层
        注册用户，并向用户发送激活码
        验证用户激活码后根据验证结果控制视图跳转

### 登录功能：
    用户流程：
        输入账号密码，输入验证码，可选长登录状态，点击登录，成功重定向主页，失败返回错误信息
    功能点分析：
        验证码功能，Cookie，Session会话管理，两种登陆保持状态
    验证码：
        kaptcha生成验证码，将验证码存入session，与用户输入的验证码作比较
    数据层：
        根据username查用户
        根据userId查询登陆表
        更新登陆表中登陆状态
    业务层:
        验证username
        验证password
        更新用户登陆状态
    表现层：
        检查验证码
        根据rememberMe设置登录持续时间（三元表达式）
        创建Cookie，设置路径与最大存活时间，存入ticket
        控制视图跳转，重定向首页

    th:checked="${param.rememberMe} 
    mapper类中参数字段要与xml配置文件中参数字段一致

### 更新登录后页面
    拦截器：统一处理多个请求的操作
    -定义拦截器：实现HandlerInterceptor接口
    -配置拦截器，实现WebMvcConfigur接口，注册拦截器，排除静态资源
    
    -自定义拦截器
        先封装一个工具类，从request获取cookie，从cookie中取出ticket的值
        preHandler  通过ticket的值查询到用户，并将用户保存，set进线程组
            HostHolder
                    由于服务器对应多个客户端，属于一对多的情况，考虑线程隔离，
                    故通过ThreadLocal方式保存用户，先创建一个用户的线程组，
                    设置将用户存入线程组，在从线程组中将用户取出
                    定义一个销毁线程组的方法，避免只存不出，导致资源浪费
    
        postHandler 从线程组中取出用户，并将用户通过ModelAndView返回给前端

        afterHandler 在返回视图后，关闭连接前，将用户移除

### 账号设置
    - 上传头像
    - 修改密码
    上传文件
        - POST请求
        - encType:"multipart/form-data"
        - Spring MVC: 通过MultipartFile上传文件
    开发步骤
        - 访问账号设置页面
        - 上传头像
        - 更新头像

### 检测登陆状态
    - 防止未登录用户通过路径访问登陆后功能
    处理批量请求,考虑使用拦截器,不需要拦截所有,可以自定义注解,用注解对方法进行标记,只拦截有注解的方法
    - 检测登陆状态,如果未登录,则拦截所有请求,只检测带有该注解的方法 (设置页方法,更新头像)

### 前缀树
    前缀树
    - Trie字典树,查找树
    - 查询效率高,花费内存大
    - 字符串检索,词频统计,字符串排序

    敏感词过滤器
    - 定义敏感词
        resource文件夹下的sensitive-word.text文件
    - 根据敏感词初始化前缀树结构
        定义前缀树结构：定义一个分支结束的标识位，定义节点类型，添加节点方法，获取节点方法
        初始化敏感词文件：
            通过反射的方式获取文件输入流，
            使用BufferReader从字符输入流中读取文本，
            按行读取文本保存为敏感词
            定义一个将敏感词字符添加到前缀树的方法，编写此方法将敏感词添加到前缀树中
            遍历敏感词为单个字符，将字符添加到节点
    - 编写过滤敏感词方法

### 发布帖子
    - AJAX
        - Asynchronous JavaScript and XML
        - 异步的JavaScript和XML，不是新技术，只是新术语
        - 不需要刷新网页，既可以显示增量更新
    - 使用jQuery 发送Ajax请求
    - 使用Ajax请求实现发帖子功能

### 帖子详情页
    - 跳转到帖子详情页
    - 帖子对应的用户信息，用帖子id查到对应的发帖人id，通过发帖人id查到发帖人

### 显示评论
    - 与显示主页类似
    数据层
        - 查询一页的评论
        - 查询回复评论数
    业务层
        - 获取带分页评论
        - 获取回复评论数
    表现层
        - 在帖子详情页底部添加评论别表
    注意对二级回复目标对象的判断！
    判断二级回复的目标对象是否存在，不存在则返回null，存在则查询目标用户

### 添加评论
    数据层
        插入评论
        修改评论数
    业务层
        先添加评论，后修改评论数
    表现层
        处理添加评论请求
        处理表单数据

### 私信列表
    查询当前用户的会话列表
    显示每个会话的最新一条数据
    支持分页显示

    查询每个会话的全部私信
    支持分页显示

### 发送私信
    发送私信
        异步方式发送私信
        发送成功后刷新私信列表
    设置已读
        访问私信详情时,将私信设置成已读状态

### 统一处理异常
    ControllerAdvice
### 点赞处理
    